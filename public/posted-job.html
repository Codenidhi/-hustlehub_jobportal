<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hustle Hub - Manage Jobs</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', 'Poppins', Arial, sans-serif;
      color: #000;
      background: #f5f5f5;
      min-height: 100vh;
    }

    .content-wrapper {
      max-width: 1440px;
      margin: 0 auto;
      padding: 0 16px;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 10;
      padding: 20px 0;
      background-color: rgba(93, 89, 89, 0.62);
      backdrop-filter: blur(10px);
    }

    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-family: 'Poppins', sans-serif;
      font-weight: 900;
      font-size: 24px;
      color: #fff;
      text-decoration: none;
    }

    .nav-links {
      display: none;
      list-style: none;
      gap: 20px;
    }

    .nav-links a {
      font-weight: 500;
      font-size: 16px;
      color: #fff;
      text-decoration: none;
    }

    .header-icons {
      display: flex;
      gap: 10px;
    }

    .icon-button {
      background: none;
      border: none;
      font-size: 20px;
      color: #fff;
      cursor: pointer;
    }

    main {
      padding-top: 100px;
      padding-bottom: 80px;
      min-height: calc(100vh - 200px);
    }

    .page-header {
      margin-bottom: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }

    .page-header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 32px;
      font-weight: 800;
      color: #333;
    }

    .post-job-btn {
      padding: 12px 24px;
      background: #000;
      color: #fff;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: background 0.3s;
    }

    .post-job-btn:hover {
      background: #333;
    }

    .job-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 24px;
      overflow: hidden;
    }

    .job-header {
      background: #000;
      padding: 24px;
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
    }

    .job-title-section h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .job-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      font-size: 14px;
      opacity: 0.95;
    }

    .job-meta span {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .delete-btn {
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
      border: 2px solid #fff;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .delete-btn:hover {
      background: #333;
      color: #fff;
    }

    .job-body {
      padding: 24px;
    }

    .applicants-section {
      padding-top: 24px;
    }

    .applicants-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .applicants-header h3 {
      font-size: 20px;
      font-weight: 700;
      color: #333;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .applicant-count {
      background: #000;
      color: #fff;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
    }

    .applicants-table {
      width: 100%;
      background: #fafafa;
      border-radius: 8px;
      overflow: hidden;
    }

    .applicants-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .applicants-table thead {
      background: #333;
      color: #fff;
    }

    .applicants-table th {
      padding: 14px 12px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }

    .applicants-table td {
      padding: 16px 12px;
      border-bottom: 1px solid #e0e0e0;
      font-size: 14px;
      color: #333;
    }

    .applicants-table tr:last-child td {
      border-bottom: none;
    }

    .applicants-table tbody tr:hover {
      background: #f0f0f0;
    }

    .action-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      text-decoration: none;
      color: #fff;
    }

    .view-pdf-btn {
      background: #000;
      margin-right: 8px;
    }

    .view-pdf-btn:hover {
      background: #333;
    }

    .view-profile-btn {
      background: #000;
      margin-right: 8px;
    }

    .view-profile-btn:hover {
      background: #333;
    }

    .send-invite-btn {
      background: #000;
    }

    .send-invite-btn:hover {
      background: #333;
    }

    .send-invite-btn.sent {
      background: #9E9E9E;
      cursor: not-allowed;
    }

    .no-applicants {
      text-align: center;
      padding: 40px;
      color: #999;
    }

    .no-applicants i {
      font-size: 48px;
      margin-bottom: 16px;
      color: #ddd;
    }

    .no-jobs {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }

    .no-jobs i {
      font-size: 64px;
      margin-bottom: 20px;
      color: #ddd;
    }

    .footer {
      width: 100%;
      padding: 40px 0;
      background-color: rgba(30, 30, 30, 0.5);
      margin-top: auto;
    }

    .footer-content {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .footer-main {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .footer-brand {
      font-family: 'Poppins', sans-serif;
      font-weight: 900;
      font-size: 30px;
      color: #fff;
    }

    .footer-line {
      width: 100%;
      height: 3px;
      background-color: #fff;
    }

    @media (min-width: 640px) {
      .nav-links {
        display: flex;
      }
      .footer-main {
        flex-direction: row;
        justify-content: space-between;
      }
    }

    @media (max-width: 768px) {
      .applicants-table {
        overflow-x: auto;
      }
      
      .job-header {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
<header class="header">
  <nav class="nav content-wrapper">
    <a href="index.html" class="logo">HUSTLE HUB</a>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="search-jobs.html">Search Jobs</a></li>
      <li><a href="post-job.html">Post Job</a></li>
    </ul>
    <div class="header-icons">
      <button class="icon-button"><i class="fas fa-bell"></i></button>
      <button class="icon-button"><i class="fas fa-user-circle"></i></button>
    </div>
  </nav>
</header>

<main>
  <section class="content-wrapper">
    <div class="page-header">
      <h1>Manage Your Jobs</h1>
      <a href="post-job.html" class="post-job-btn">
        <i class="fas fa-plus"></i> Post New Job
      </a>
    </div>

    <div id="jobs-container"></div>
  </section>
</main>

<footer class="footer">
  <div class="footer-content content-wrapper">
    <div class="footer-main">
      <div class="footer-brand">HUSTLE HUB</div>
    </div>
    <div class="footer-line"></div>
  </div>
</footer>

<script>
  const mockApplicants = {};

  function generateMockApplicants(jobId) {
    const names = ['Riya Mehra', 'Arjun Reddy', 'Neha Kapoor', 'Alia Bhatt'];
    const emails = ['riya@gmail.com', 'arjun@gmail.com', 'neha@gmail.com', 'alia@gmail.com'];
    const locations = ['Bangalore, India', 'Mumbai, India', 'Delhi, India', 'Pune, India'];
    const qualifications = ["Bachelor's Degree", "Master's Degree", "Bachelor's Degree", "Master's Degree"];
    
    const numApplicants = Math.floor(Math.random() * 5);
    const applicants = [];
    
    for (let i = 0; i < numApplicants; i++) {
      applicants.push({
        id: Date.now() + i,
        name: names[i % names.length],
        email: emails[i % emails.length],
        location: locations[i % locations.length],
        qualification: qualifications[i % qualifications.length],
        inviteSent: false
      });
    }
    
    return applicants;
  }

  async function loadJobs() {
    const container = document.getElementById('jobs-container');
    container.innerHTML = '<p style="text-align: center; color: #999;">Loading jobs...</p>';
    
    try {
      const response = await fetch('http://localhost:3000/jobs');
      
      if (!response.ok) {
        throw new Error('Server error');
      }
      
      const jobs = await response.json();
      
      if (jobs.length === 0) {
        container.innerHTML = `
          <div class="no-jobs">
            <i class="fas fa-briefcase"></i>
            <h2>No Jobs Posted Yet</h2>
            <p>Start by posting your first job opening!</p>
            <br>
            <a href="post-job.html" class="post-job-btn">
              <i class="fas fa-plus"></i> Post Your First Job
            </a>
          </div>
        `;
        return;
      }
      
      displayJobs(jobs);
    } catch (error) {
      console.error('Error loading jobs:', error);
      container.innerHTML = `
        <div class="no-jobs">
          <i class="fas fa-exclamation-triangle"></i>
          <h2>Unable to Load Jobs</h2>
          <p>Make sure the server is running on http://localhost:3000</p>
        </div>
      `;
    }
  }

  function displayJobs(jobs) {
    const container = document.getElementById('jobs-container');
    container.innerHTML = '';
    
    jobs.forEach(job => {
      if (!mockApplicants[job.id]) {
        mockApplicants[job.id] = generateMockApplicants(job.id);
      }
      
      const applicants = mockApplicants[job.id];
      
      const jobCard = document.createElement('div');
      jobCard.className = 'job-card';
      jobCard.innerHTML = `
        <div class="job-header">
          <div class="job-title-section">
            <h2>${job.title}</h2>
            <div class="job-meta">
              <span><i class="fas fa-building"></i> ${job.company}</span>
              <span><i class="fas fa-map-marker-alt"></i> ${job.location}</span>
              <span><i class="fas fa-clock"></i> ${job.type}</span>
              <span><i class="fas fa-rupee-sign"></i> ${job.salary}</span>
            </div>
          </div>
          <button class="delete-btn" onclick="deleteJob(${job.id})">
            <i class="fas fa-trash"></i> Delete
          </button>
        </div>
        
        <div class="job-body">
          <div class="applicants-section">
            <div class="applicants-header">
              <h3>
                Applicants
                <span class="applicant-count">${applicants.length}</span>
              </h3>
            </div>
            
            ${applicants.length > 0 ? `
              <div class="applicants-table">
                <table>
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Email</th>
                      <th>Location</th>
                      <th>Qualification</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${applicants.map(applicant => `
                      <tr>
                        <td><strong>${applicant.name}</strong></td>
                        <td>${applicant.email}</td>
                        <td>${applicant.location}</td>
                        <td>${applicant.qualification}</td>
                        <td>
                          <button class="action-btn view-pdf-btn" onclick="viewPDF('${applicant.name}')">
                            <i class="fas fa-file-pdf"></i> View PDF
                          </button>
                          <button class="action-btn view-profile-btn" onclick="viewProfile('${applicant.name}')">
                            <i class="fas fa-user"></i> View Profile
                          </button>
                          <button class="action-btn send-invite-btn ${applicant.inviteSent ? 'sent' : ''}" 
                                  onclick="sendInvite(${job.id}, ${applicant.id})"
                                  ${applicant.inviteSent ? 'disabled' : ''}>
                            <i class="fas fa-envelope"></i> 
                            ${applicant.inviteSent ? 'Invitation Sent' : 'Send Invitation'}
                          </button>
                        </td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
            ` : `
              <div class="no-applicants">
                <i class="fas fa-user-slash"></i>
                <p>No applicants yet for this position</p>
              </div>
            `}
          </div>
        </div>
      `;
      
      container.appendChild(jobCard);
    });
  }

  async function deleteJob(jobId) {
    if (!confirm('Are you sure you want to delete this job posting?')) {
      return;
    }
    
    try {
      const response = await fetch(`http://localhost:3000/jobs/${jobId}`, {
        method: 'DELETE'
      });
      
      const data = await response.json();
      
      if (data.success) {
        alert('Job deleted successfully!');
        delete mockApplicants[jobId];
        loadJobs();
      } else {
        alert('Failed to delete job: ' + data.message);
      }
    } catch (error) {
      console.error('Error deleting job:', error);
      alert('Error deleting job. Please try again.');
    }
  }

  function viewPDF(applicantName) {
    alert(`Opening resume for ${applicantName}...\n\nIn a real application, this would open the PDF file.`);
  }

  function viewProfile(applicantName) {
    alert(`Opening profile for ${applicantName}...\n\nIn a real application, this would show detailed applicant profile.`);
  }

  function sendInvite(jobId, applicantId) {
    const applicant = mockApplicants[jobId].find(a => a.id === applicantId);
    
    if (applicant && !applicant.inviteSent) {
      applicant.inviteSent = true;
      alert(`Interview invitation sent to ${applicant.name}!\n\nEmail: ${applicant.email}\n\nThey will receive an email with interview details.`);
      loadJobs();
    }
  }

  window.addEventListener('DOMContentLoaded', loadJobs);
</script>

</body>
</html>